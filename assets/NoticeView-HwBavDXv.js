import{_ as I,e as S,c as o,a as i,b as v,w as n,t as _,f as C,F as w,g as $,h,i as U,j as x,r as m,k as j,l as A,o as s,d as p}from"./index-DY4mJ8SQ.js";const O={class:"notice-page"},T={class:"notice-container"},W={class:"notice-sidebar"},G={key:0,style:{padding:"20px","text-align":"center",color:"#999"}},H={class:"notice-content"},J={key:0,class:"notice-list-wrap"},K={class:"notice-title"},P={class:"notice-time"},Q={key:0,class:"empty-tip",style:{"text-align":"center",padding:"20px",color:"#999"}},R={key:1,class:"empty-tip",style:{"text-align":"center",padding:"20px",color:"#999"}},X={key:1,class:"notice-detail-wrap"},Z={class:"detail-title"},ee={class:"detail-content"},te={key:0,class:"file-list"},le={key:2,class:"no-file-tip",style:{"text-align":"center",color:"#999",padding:"20px"}},se={class:"nav-buttons"},ae={__name:"NoticeView",setup(ne){const N=A({}),y=x([]),d=x(""),k=j(()=>N[d.value]||[]),a=x(null),u=x(-1),E=t=>{d.value=t,a.value=null,N[t]||B(t)},q=(t,e)=>{a.value=t,u.value=e},Y=t=>{t==="prev"&&u.value>0?u.value--:t==="next"&&u.value<k.value.length-1&&u.value++,a.value=k.value[u.value]},F=async()=>{try{const t=await U.get("/notice/queryAllYears");t.code===200&&(y.value=t.data||[],y.value.length>0&&(d.value=y.value[0],B(d.value)))}catch(t){console.error("加载年份失败",t)}},B=async t=>{try{const e=await U.get("/notice/queryByYear",{params:{year:t}});e.code===200&&(N[t]=(e.data||[]).map(c=>({...c,files:c.files||(c.fileUrl?[{fileUrl:c.fileUrl,fileName:c.fileName}]:[])})))}catch(e){console.error(`加载${t}年通知失败`,e)}};S(()=>{F()});const V=(t,e=!1,c="")=>{try{let f=t;if(t.startsWith("http")||(f=`http://localhost:8080${t}`),e){const r=document.createElement("a");r.href=f,r.download=c||"文件",document.body.appendChild(r),r.click(),document.body.removeChild(r),ElMessage.success(`开始下载：${c||"文件"}`)}else window.open(f,"_blank")}catch(f){console.error("文件操作失败：",f),ElMessage.error("文件预览/下载失败，请重试")}};return(t,e)=>{const c=m("el-menu-item"),f=m("el-menu"),r=m("el-breadcrumb-item"),L=m("el-breadcrumb"),M=m("el-list-item"),z=m("el-list"),b=m("el-button");return s(),o("div",O,[i("div",T,[i("div",W,[e[3]||(e[3]=i("div",{class:"sidebar-title"},"赛事通知",-1)),v(f,{"default-active":d.value,class:"year-menu",onSelect:E},{default:n(()=>[(s(!0),o(w,null,$(y.value,l=>(s(),h(c,{key:l,index:l},{default:n(()=>[p(_(l)+"年通知 ",1)]),_:2},1032,["index"]))),128)),y.value.length===0?(s(),o("div",G," 暂无通知年份数据 ")):C("",!0)]),_:1},8,["default-active"])]),i("div",H,[v(L,{separator:">"},{default:n(()=>[v(r,{to:{path:"/"}},{default:n(()=>[...e[4]||(e[4]=[p("首页",-1)])]),_:1}),v(r,{to:{path:"/notice"}},{default:n(()=>[...e[5]||(e[5]=[p("赛事通知",-1)])]),_:1}),v(r,null,{default:n(()=>[p(_(d.value)+"年通知",1)]),_:1})]),_:1}),a.value?(s(),o("div",X,[i("h3",Z,_(a.value.title),1),i("div",ee,[a.value.files&&a.value.files.length>0?(s(),o("div",te,[(s(!0),o(w,null,$(a.value.files,(l,g)=>(s(),h(b,{key:g,type:"text",size:"small",onClick:D=>V(l.fileUrl,!0,l.fileName||`附件${g+1}`),class:"pdf-link",style:{display:"block",margin:"4px 0",color:"#409eff"}},{default:n(()=>[p(_(l.fileName||`附件${g+1}`)+".pdf ",1),e[6]||(e[6]=i("i",{class:"el-icon-download"},null,-1))]),_:2},1032,["onClick"]))),128))])):a.value.fileUrl?(s(),h(b,{key:1,type:"text",size:"small",onClick:e[0]||(e[0]=l=>V(a.value.fileUrl,!0,a.value.fileName)),class:"pdf-link",style:{display:"block",margin:"4px 0",color:"#409eff"}},{default:n(()=>[p(_(a.value.fileName)+".pdf ",1),e[7]||(e[7]=i("i",{class:"el-icon-download"},null,-1))]),_:1})):(s(),o("div",le," 暂无附件 "))])])):(s(),o("div",J,[v(z,{class:"notice-list"},{default:n(()=>[(s(!0),o(w,null,$(k.value,(l,g)=>(s(),h(M,{key:l.id,onClick:D=>q(l,g),class:"notice-item"},{default:n(()=>[i("span",K,_(l.title),1),i("span",P,_(l.time),1)]),_:2},1032,["onClick"]))),128))]),_:1}),k.value.length===0&&d.value?(s(),o("div",Q," 暂无"+_(d.value)+"年通知数据 ",1)):C("",!0),!d.value&&y.value.length>0?(s(),o("div",R," 请选择左侧年份查看通知 ")):C("",!0)])),i("div",se,[v(b,{type:"text",onClick:e[1]||(e[1]=l=>Y("prev")),disabled:u.value===0},{default:n(()=>[...e[8]||(e[8]=[p(" 上一个 ",-1)])]),_:1},8,["disabled"]),v(b,{type:"text",onClick:e[2]||(e[2]=l=>Y("next")),disabled:u.value===k.value.length-1},{default:n(()=>[...e[9]||(e[9]=[p(" 下一个 ",-1)])]),_:1},8,["disabled"])])])])])}}},ie=I(ae,[["__scopeId","data-v-7aeaec08"]]);export{ie as default};
