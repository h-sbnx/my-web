import{_ as g,c as w,a as i,b as o,w as r,r as u,u as y,o as v,m as b,d as V,i as h,E as l,k,e as x}from"./index-C6xAr2tu.js";const q={class:"admin-login-container"},U={class:"login-card"},N={__name:"AdminLogin",setup($){const n=y(),c=x(!1),s=h({username:"",password:""}),p=async()=>{if(!s.username||!s.password)return l.warning("请输入账号和密码");c.value=!0,l.closeAll();try{const e=await k.post("http://localhost:8080/api/admin/login",{username:s.username,password:s.password});if(e&&e.data&&e.data.code===200){localStorage.setItem("adminToken",e.data.data.token),localStorage.setItem("adminUser",JSON.stringify(e.data.data.user)),l.success("登录成功");const d=n.currentRoute.query?.redirect||n.currentRoute.value?.query?.redirect||"/admin";await n.push(d).catch(t=>{console.error("跳转失败:",t),n.push("/admin")})}else l.error(`登录失败：${e.data?.message||"服务器返回异常"}`)}catch(a){let e="网络异常";a.response?(e=a.response.data?.message||`请求失败（${a.response.status}）`,[401,403].includes(a.response.status)&&(e="账号或密码错误，请重新输入")):a.message&&(e=a.message),l.error(`登录失败：${e}`)}finally{c.value=!1}};return(a,e)=>{const d=u("el-input"),t=u("el-form-item"),f=u("el-button"),_=u("el-form");return v(),w("div",q,[i("div",U,[e[3]||(e[3]=i("div",{class:"login-header"},[i("h2",null,"大赛管理后台"),i("p",null,"请输入管理员账号密码登录")],-1)),o(_,{model:s,class:"login-form"},{default:r(()=>[o(t,{label:"用户名",required:""},{default:r(()=>[o(d,{modelValue:s.username,"onUpdate:modelValue":e[0]||(e[0]=m=>s.username=m),placeholder:"请输入用户名","prefix-icon":"el-icon-user",size:"large"},null,8,["modelValue"])]),_:1}),o(t,{label:"密码",required:""},{default:r(()=>[o(d,{modelValue:s.password,"onUpdate:modelValue":e[1]||(e[1]=m=>s.password=m),type:"password",placeholder:"请输入密码","prefix-icon":"el-icon-lock",size:"large",onKeyup:b(p,["enter"])},null,8,["modelValue"])]),_:1}),o(t,null,{default:r(()=>[o(f,{type:"primary",size:"large",class:"login-btn",onClick:p,loading:c.value},{default:r(()=>[...e[2]||(e[2]=[V(" 登录 ",-1)])]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])])])}}},A=g(N,[["__scopeId","data-v-7d038b7a"]]);export{A as default};
