import{_ as q,e as M,c as d,a as b,b as a,w as r,i as C,E as f,j as y,r as i,o,F as V,g as Y,h as x,u as P,d as g,t as v}from"./index-DWDpl3uH.js";const j={class:"public-page"},z={class:"public-container"},A={class:"year-selector",style:{"margin-bottom":"20px"}},I={key:0,style:{"text-align":"center",padding:"40px 0",color:"#999"}},O={key:1,class:"empty-tip",style:{"text-align":"center",padding:"40px 0",color:"#999"}},U={key:0,class:"file-list"},W={key:1,style:{color:"#999"}},G={__name:"PublicView",setup(H){const m=y([]),p=y(""),h=y([]),u=y(!1),B=async()=>{try{u.value=!0;const t=await C.get("/public/queryAllYears");t.code===200&&(m.value=t.data||[],m.value.length>0&&(p.value=m.value[0],$(p.value)))}catch(t){console.error("加载公示年份失败",t),f.error("加载公示年份失败，请刷新重试")}finally{u.value=!1}},$=async t=>{if(t)try{u.value=!0;const e=await C.get("/public/queryByYear",{params:{year:t}});e.code===200&&(h.value=e.data.map(n=>({...n,files:n.files||[]})))}catch(e){console.error("加载赛事公示数据失败",e),f.error("加载公示数据失败，请刷新重试")}finally{u.value=!1}},D=t=>{p.value=t,$(t)};M(()=>{B()});const T=t=>{if(!t)return"";const e=new Date(t),n=e.getFullYear(),s=String(e.getMonth()+1).padStart(2,"0"),c=String(e.getDate()).padStart(2,"0");return`${n}-${s}-${c}`},E=(t,e=!1,n="")=>{try{let s=t;if(t.startsWith("http")||(s=`http://116.62.235.114:8080${t}`),e){const c=document.createElement("a");c.href=s,c.download=n||"文件",document.body.appendChild(c),c.click(),document.body.removeChild(c),f.success(`开始下载：${n||"文件"}`)}else window.open(s,"_blank")}catch(s){console.error("文件操作失败：",s),f.error("文件预览/下载失败，请重试")}};return(t,e)=>{const n=i("el-option"),s=i("el-select"),c=i("el-icon"),_=i("el-table-column"),F=i("el-tag"),L=i("el-button"),N=i("el-table"),S=i("el-card");return o(),d("div",j,[b("div",z,[e[3]||(e[3]=b("h2",{class:"page-title"},"赛事公示",-1)),b("div",A,[a(s,{modelValue:p.value,"onUpdate:modelValue":e[0]||(e[0]=l=>p.value=l),placeholder:"请选择年份",style:{width:"200px"},onChange:D,disabled:u.value},{default:r(()=>[(o(!0),d(V,null,Y(m.value,l=>(o(),x(n,{key:l,label:`${l}年`,value:l},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),a(S,{class:"public-card"},{default:r(()=>[u.value?(o(),d("div",I,[a(c,null,{default:r(()=>[a(P(u))]),_:1}),e[1]||(e[1]=g(" 加载中... ",-1))])):h.value.length===0?(o(),d("div",O," 暂无"+v(p.value)+"年赛事公示数据 ",1)):(o(),x(N,{key:2,data:h.value,border:"",style:{width:"100%"},class:"public-table"},{default:r(()=>[a(_,{prop:"id",label:"序号",width:"80",align:"center"}),a(_,{prop:"title",label:"公示标题","min-width":"300"}),a(_,{prop:"publicTime",label:"公示时间",width:"180",align:"center"},{default:r(l=>[g(v(T(l.row.publicTime)),1)]),_:1}),a(_,{prop:"publicType",label:"公示类型",width:"120",align:"center"},{default:r(l=>[a(F,{type:"info"},{default:r(()=>[g(v(l.row.publicType),1)]),_:2},1024)]),_:1}),a(_,{label:"公示文件","min-width":"200",align:"center"},{default:r(l=>[l.row.files.length>0?(o(),d("div",U,[(o(!0),d(V,null,Y(l.row.files,(w,k)=>(o(),x(L,{key:k,type:"text",size:"small",onClick:J=>E(w.fileUrl,!0,w.fileName||`文件${k+1}`),style:{display:"block",margin:"4px 0",color:"#409eff"}},{default:r(()=>[g(v(w.fileName||`文件${k+1}`)+" ",1),e[2]||(e[2]=b("i",{class:"el-icon-download"},null,-1))]),_:2},1032,["onClick"]))),128))])):(o(),d("span",W,"无附件"))]),_:1})]),_:1},8,["data"]))]),_:1})])])}}},Q=q(G,[["__scopeId","data-v-06950934"]]);export{Q as default};
