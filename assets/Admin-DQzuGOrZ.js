import{_ as Pe,e as je,E as s,q as Oe,c as T,a as c,b as a,w as r,u as l,s as y,i as w,v as He,j as x,r as Te,p as Ye,l as z,o as v,d as n,x as D,y as K,z as _,A as re,B as se,C as d,t as f,D as de,f as H,G as ye,H as be,I as h,F as Y,g as W,h as I,J as ne,K as F,L as xe,M as Ne,N as We,m as pe}from"./index-DY4mJ8SQ.js";import{i as Ge}from"./jwtUtil-DU9BCR_A.js";const Qe={class:"admin-page"},Je={class:"admin-header"},Xe={class:"header-right"},Ke={class:"tab-container"},Ze={class:"card-container"},el={style:{"user-select":"text",cursor:"text"}},ll={key:0},al={key:0,class:"team-detail"},tl={class:"detail-section"},ol={class:"detail-section",style:{"margin-top":"20px"}},rl={key:0,style:{display:"flex","flex-direction":"column",gap:"4px"}},sl={key:1,style:{color:"#999"}},nl={class:"detail-section",style:{"margin-top":"20px"}},il={key:2,class:"empty-tip"},ul={class:"card-container"},dl={key:0,class:"file-list"},pl={key:1},fl={class:"card-container"},cl={key:0,class:"file-list"},ml={key:1},vl={class:"card-container"},k="",ie="http://localhost:8080",yl={__name:"Admin",setup(bl){const B=Ye(),Ve=async()=>{try{await pe.confirm("确定要退出登录吗？","退出确认",{type:"warning",appendToBody:!0}),localStorage.removeItem("adminToken"),localStorage.removeItem("adminUser"),delete w.defaults.headers.common.Authorization,await B.replace("/login"),location.reload()}catch(t){console.log("用户取消退出",t)}},Ie=async()=>{try{const t=localStorage.getItem("adminToken");return t?Ge(t)?(s.warning("登录已过期，请重新登录"),localStorage.removeItem("adminToken"),localStorage.removeItem("adminUser"),await B.replace("/login"),!1):!0:(s.warning("请先登录管理员账号"),await B.replace("/login"),!1)}catch(t){return console.error("鉴权校验失败：",t),s.error("登录状态校验异常，请重新登录"),localStorage.clear(),await B.replace("/login"),!1}},b=x(!1),P=x(!1),ge=x("teamManage"),Z=z({workId:""}),M=x([]),m=x(null),fe=x(!1),Le=async()=>{if(!Z.workId){await we();return}b.value=!0;try{const t=await w.get(`${k}/team/queryByWorkId`,{params:{workId:Z.workId}});t.code===200?(M.value=t.data?[t.data]:[],s.success("查询成功")):(s.error(`查询失败：${t.message||"接口返回异常"}`),M.value=[])}catch(t){const e=t.response?.data?.message||"网络异常/接口未实现";s.error(`查询失败：${e}`),M.value=[]}finally{b.value=!1}},we=async()=>{b.value=!0;try{const t=await w.get(`${k}/team/queryAll`);t.code===200?(M.value=t.data||[],s.success(`共查询到 ${M.value.length} 支报名队伍`)):(s.error(`查询失败：${t.message||"接口返回异常"}`),M.value=[])}catch(t){const e=t.response?.data?.message||"网络异常/接口未实现";s.error(`查询失败：${e}`),M.value=[]}finally{b.value=!1}},De=t=>{m.value=t,fe.value=!0},he=async()=>{P.value=!0;try{const t=localStorage.getItem("adminToken");if(!t){s.warning("请先登录管理员账号"),B.push("/login"),P.value=!1;return}const e=new Date().getTime(),i=`${ie}/api/file/exportPassedWorks?nocache=${e}`,u=new XMLHttpRequest;u.open("GET",i,!0),u.withCredentials=!0,u.setRequestHeader("Authorization",`Bearer ${t}`),u.responseType="blob",u.onload=function(){if(P.value=!1,u.status===200){const C=u.getResponseHeader("content-disposition");let o="已通过审核作品列表.xlsx";if(C){const ve=C.match(/filename\*=UTF-8''(.*)/);ve&&ve[1]&&(o=decodeURIComponent(ve[1]))}const p=new Blob([u.response],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),g=URL.createObjectURL(p),q=document.createElement("a");q.href=g,q.download=o,document.body.appendChild(q),q.click(),document.body.removeChild(q),URL.revokeObjectURL(g),s.success("导出成功，文件已自动下载")}else if(u.status===304)s.warning("文件缓存未更新，正在重新请求..."),window.location.reload();else{const C=new FileReader;C.onload=function(){try{const o=JSON.parse(C.result);s.error(`导出失败：${o.message}`)}catch{s.error(`导出失败：服务器返回${u.status}错误`)}},C.readAsText(u.response)}},u.onerror=function(){P.value=!1,s.error("导出请求失败：未连接到后端服务器，请检查后端是否运行在8080端口"),console.error("请求异常：后端地址可能错误或服务未启动")},u.send()}catch(t){P.value=!1,s.error(`导出失败：${t.message}`),console.error("导出逻辑异常：",t)}},R=z({publicType:"",year:""}),ee=x([]),ue=x([]),U=z({id:null,title:"",publicTime:"",publicType:"",files:[]}),S=x([]),le=x(!1),j=x(!1),G=z({action:`${ie}/api/public/upload`,headers:()=>({Authorization:`Bearer ${localStorage.getItem("adminToken")}`}),onSuccess:(t,e,i)=>{t.code===200?(S.value=i.filter(u=>u.status==="success"),U.files=S.value.map(u=>({fileUrl:u?.raw?.uploadResponse?.data?.fileUrl||u?.response?.data?.fileUrl||"",fileName:u?.raw?.uploadResponse?.data?.fileName||u?.response?.data?.fileName||u.name})),e.raw.uploadResponse=t,s.success(`已上传 ${U.files.length}/5 个文件`)):s.error(`文件上传失败：${t.message||"接口返回异常"}`)},onError:t=>{s.error("公示文件上传失败")},beforeUpload:t=>t.type==="application/pdf"||t.name.endsWith(".pdf")?S.value.length>=5?(s.warning("最多只能上传5个PDF文件！"),!1):!0:(s.error("仅支持PDF格式文件上传！"),!1),onRemove:(t,e)=>{S.value=e,U.files=S.value.map(i=>({fileUrl:i?.raw?.uploadResponse?.data?.fileUrl||i?.response?.data?.fileUrl||"",fileName:i?.raw?.uploadResponse?.data?.fileName||i?.response?.data?.fileName||i.name})),s.info(`已移除文件：${t.name}`)}}),Re=async()=>{try{const t=await w.get(`${k}/public/queryAllYears`);t.code===200?ue.value=t.data||[]:(s.error(`加载公示年份失败：${t.message||"接口返回异常"}`),ue.value=[])}catch{s.error("加载公示年份列表失败"),ue.value=[]}},ae=async()=>{b.value=!0;try{let t;R.year?t=await w.get(`${k}/public/queryByYear`,{params:{year:R.year}}):R.publicType?t=await w.get(`${k}/public/queryByType`,{params:{publicType:R.publicType}}):t=await w.get(`${k}/public/queryAll`),t.code===200?(ee.value=(t.data||[]).map(e=>({...e,files:e.files||(e.fileUrl?[{fileUrl:e.fileUrl,fileName:e.fileName}]:[])})),ee.value.length===0&&s.info("暂无公示数据，可点击「新增公示」添加")):(s.error(`查询公示失败：${t.message||"接口返回异常"}`),ee.value=[])}catch(t){const e=t.response?.data?.message||"网络异常/接口未实现";s.error(`查询公示失败：${e}`),ee.value=[]}finally{b.value=!1}},ke=(t=null)=>{t?(Object.assign(U,{...t,files:t.files||(t.fileUrl?[{fileUrl:t.fileUrl,fileName:t.fileName}]:[])}),S.value=U.files.map(e=>({name:e.fileName,url:e.fileUrl,status:"success",response:{data:e}})),j.value=!0):(Object.assign(U,{id:null,title:"",publicTime:"",publicType:"",files:[]}),S.value=[],j.value=!1),le.value=!0},Ee=async()=>{if(!U.title)return s.error("公示标题不能为空");if(!U.publicTime)return s.error("公示时间不能为空");if(!U.publicType)return s.error("公示类型不能为空");b.value=!0;try{let t;const e={...U};j.value?t=await w.put(`${k}/public/update`,e):t=await w.post(`${k}/public/add`,e),t.code===200?(s.success(j.value?"公示修改成功":"公示新增成功"),le.value=!1,ae()):s.error(`${j.value?"修改":"新增"}失败：${t.message||"接口返回异常"}`)}catch(t){const e=t.response?.data?.message||"网络异常/接口未实现";s.error(`${j.value?"修改":"新增"}失败：${e}`)}finally{b.value=!1}},qe=async t=>{pe.confirm("确定要删除该公示吗？","删除确认",{type:"warning"}).then(async()=>{b.value=!0;try{const e=await w.delete(`${k}/public/delete`,{params:{id:t}});e.code===200?(s.success("公示删除成功"),ae()):s.error(`删除失败：${e.message||"接口返回异常"}`)}catch(e){const i=e.response?.data?.message||"网络异常/接口未实现";s.error(`删除失败：${i}`)}finally{b.value=!1}})},Q=z({year:""}),J=x([]),E=x([]),$=z({id:null,title:"",time:"",year:"",files:[]}),A=x([]),te=x(!1),O=x(!1),ze=t=>{if(!t)return;let e;if(typeof t=="string"){const i=t.split("-");if(i.length===3&&i[0].length===4)e=i[0];else{s.warning("时间格式错误，请选择正确的日期");return}}e&&($.year=e,E.value.includes(e)||(E.value.push(e),E.value=E.value.sort((i,u)=>u-i)))},X=z({action:`${ie}/api/public/upload`,headers:()=>({Authorization:`Bearer ${localStorage.getItem("adminToken")}`}),onSuccess:(t,e,i)=>{t.code===200?(A.value=i.filter(u=>u.status==="success"),$.files=A.value.map(u=>({fileUrl:u?.raw?.uploadResponse?.data?.fileUrl||u?.response?.data?.fileUrl||"",fileName:u?.raw?.uploadResponse?.data?.fileName||u?.response?.data?.fileName||u.name})),e.raw.uploadResponse=t,s.success(`已上传 ${$.files.length}/5 个文件`)):s.error(`附件上传失败：${t.message||"接口返回异常"}`)},onError:t=>{s.error("通知附件上传失败")},beforeUpload:t=>t.type==="application/pdf"||t.name.endsWith(".pdf")?A.value.length>=5?(s.warning("最多只能上传5个PDF文件！"),!1):!0:(s.error("仅支持PDF格式文件上传！"),!1),onRemove:(t,e)=>{A.value=e,$.files=A.value.map(i=>({fileUrl:i?.raw?.uploadResponse?.data?.fileUrl||i?.response?.data?.fileUrl||"",fileName:i?.raw?.uploadResponse?.data?.fileName||i?.response?.data?.fileName||i.name})),s.info(`已移除文件：${t.name}`)}}),Fe=async()=>{try{const t=await w.get(`${k}/notice/queryAllYears`);t.code===200?E.value=t.data||[]:(s.error(`加载年份失败：${t.message||"接口返回异常"}`),E.value=[])}catch{s.error("加载年份列表失败"),E.value=[]}},ce=async()=>{b.value=!0;try{if(!Q.year){J.value=[],s.info("请先选择年份查询通知"),b.value=!1;return}const t=await w.get(`${k}/notice/queryByYear`,{params:{year:Q.year}});t.code===200?(J.value=(t.data||[]).map(e=>({...e,files:e.files||(e.fileUrl?[{fileUrl:e.fileUrl,fileName:e.fileName}]:[])})),J.value.length===0&&s.info(`${Q.year}年暂无通知数据，可点击「新增通知」添加`)):(s.error(`查询通知失败：${t.message||"接口返回异常"}`),J.value=[])}catch(t){const e=t.response?.data?.message||"网络异常/接口未实现";s.error(`查询通知失败：${e}`),J.value=[]}finally{b.value=!1}},$e=(t=null)=>{t?(Object.assign($,{...t,files:t.files||(t.fileUrl?[{fileUrl:t.fileUrl,fileName:t.fileName}]:[])}),A.value=$.files.map(e=>({name:e.fileName,url:e.fileUrl,status:"success",response:{data:e}})),O.value=!0):(Object.assign($,{id:null,title:"",time:"",year:"",files:[]}),A.value=[],O.value=!1),te.value=!0},Me=async()=>{if(!$.title)return s.error("通知标题不能为空");if(!$.time)return s.error("发布时间不能为空");if(!$.year)return s.error("所属年份不能为空");b.value=!0;try{let t;const e={...$};O.value?t=await w.put(`${k}/notice/update`,e):t=await w.post(`${k}/notice/add`,e),t.code===200?(s.success(O.value?"通知修改成功":"通知新增成功"),te.value=!1,ce()):s.error(`${O.value?"修改":"新增"}失败：${t.message||"接口返回异常"}`)}catch(t){const e=t.response?.data?.message||"网络异常/接口未实现";s.error(`${O.value?"修改":"新增"}失败：${e}`)}finally{b.value=!1}},Se=async t=>{pe.confirm("确定要删除该通知吗？","删除确认",{type:"warning"}).then(async()=>{b.value=!0;try{const e=await w.delete(`${k}/notice/delete`,{params:{id:t}});e.code===200?(s.success("通知删除成功"),ce()):s.error(`删除失败：${e.message||"接口返回异常"}`)}catch(e){const i=e.response?.data?.message||"网络异常/接口未实现";s.error(`删除失败：${i}`)}finally{b.value=!1}})},L=z({workId:"",fileName:""}),N=x([]),V=z({pageNum:1,pageSize:10,total:0}),oe=async()=>{b.value=!0;try{const t=await w.get(`${k}/file/queryAll`);t.code===200?(N.value=(t.data||[]).map(e=>({...e,auditStatusText:e.status===1?"审核通过":e.status===2?"审核驳回":"待审核"})),V.total=N.value.length,s.success(`共查询到 ${N.value.length} 个作品文件`)):(s.error(`查询失败：${t.message||"接口返回异常"}`),N.value=[],V.total=0)}catch(t){const e=t.response?.data?.message||"网络异常/接口未实现";s.error(`查询失败：${e}`),N.value=[],V.total=0}finally{b.value=!1}},Ae=async()=>{if(!L.workId&&!L.fileName){await oe();return}b.value=!0;try{const t=await w.get(`${k}/file/queryByWorkId`,{params:{workId:L.workId}});t.code===200?(N.value=(t.data||[]).map(e=>({...e,auditStatusText:e.status===1?"审核通过":e.status===2?"审核驳回":"待审核"})),V.total=N.value.length,s.success(`查询到 ${N.value.length} 个文件`)):(s.error(`查询失败：${t.message||"接口返回异常"}`),N.value=[],V.total=0)}catch(t){const e=t.response?.data?.message||"网络异常/接口未实现";s.error(`查询失败：${e}`),N.value=[],V.total=0}finally{b.value=!1}},_e=async(t,e)=>{const i=e?"审核通过":"审核驳回",u=e?`确定要${i}该作品文件吗？`:`确定要${i}并删除该作品文件吗？删除后对应的报名队伍将无法查询到！`;pe.confirm(u,"审核确认",{type:"warning",dangerMode:!e}).then(async()=>{b.value=!0;try{e?(await w.post(`${k}/file/audit`,{id:t.id,status:1})).code===200&&(t.status=1,t.auditStatusText="审核通过",s.success(`作品文件${i}成功`)):(await w.post(`${k}/file/audit`,{id:t.id,status:2}),(await w.delete(`${k}/file/delete`,{params:{id:t.id}})).code===200&&(N.value=N.value.filter(o=>o.id!==t.id),V.total=N.value.length,s.success(`作品文件${i}并删除成功`)))}catch{s.error("操作失败")}finally{b.value=!1}})},me=(t,e=!1,i="")=>{try{if(!localStorage.getItem("adminToken")){s.warning("请先登录管理员账号"),B.push("/login");return}const C=`${ie}${t}`;if(e){const o=document.createElement("a");o.href=C,o.download=i||"文件",o.download=encodeURIComponent(o.download),document.body.appendChild(o),o.click(),document.body.removeChild(o),s.success("下载成功")}else window.open(C,"_blank")}catch{s.error("文件操作失败")}},Be=t=>{me(t,!0,"作品文件")},Ue=(t,e=!1)=>{try{const i=localStorage.getItem("adminToken");if(!i){s.warning("请先登录管理员账号"),B.push("/login");return}let u="";t.startsWith("http")?u=t:u=`${ie}/api/file/download?fileUuid=${t}`;const C="学生证照片.jpg";if(e){const o=new XMLHttpRequest;o.open("GET",u,!0),o.withCredentials=!0,o.setRequestHeader("Authorization",`Bearer ${i}`),o.responseType="blob",o.onload=function(){if(o.status===200){const p=new Blob([o.response],{type:"image/jpeg"}),g=document.createElement("a");g.href=URL.createObjectURL(p),g.download=C,document.body.appendChild(g),g.click(),document.body.removeChild(g),URL.revokeObjectURL(g.href),s.success(`下载成功：${C}`)}else s.error(`下载失败：服务器返回${o.status}错误`)},o.onerror=function(){s.error("照片下载失败，请检查网络或文件地址")},o.send()}else{const o=window.open("","_blank");if(!o){s.warning("浏览器弹窗被拦截，请允许弹窗后重试");return}o.document.body.style.textAlign="center",o.document.body.style.padding="50px",o.document.body.innerHTML="正在加载照片...";const p=new XMLHttpRequest;p.open("GET",u,!0),p.withCredentials=!0,p.setRequestHeader("Authorization",`Bearer ${i}`),p.responseType="blob",p.onload=function(){if(p.status===200){const g=URL.createObjectURL(new Blob([p.response],{type:"image/jpeg"}));o.document.body.innerHTML=`<img src="${g}" style="max-width:90%;max-height:90vh;" alt="学生证照片" />`}else o.document.body.style.color="red",o.document.body.innerHTML=`照片预览失败：服务器返回${p.status}错误`},p.onerror=function(){o.document.body.style.color="red",o.document.body.innerHTML="照片预览失败，请检查网络连接"},p.send()}}catch(i){console.error("照片操作失败：",i),s.error("学生证照片预览/下载失败，请重试")}},Ce=t=>({A:"A、医学诊疗技术与器械组",B:"B、生物医学信息工程组",C:"C、生物材料与组织工程组",D:"D、其他"})[t]||t;return je(async()=>{if(!await Ie())return;await Fe(),await Re(),await ae(),await we(),await oe();const e=JSON.parse(localStorage.getItem("adminUser")||"{}");e.username&&s.success(`欢迎回来，${e.username}`)}),(t,e)=>{const i=Te("el-tab-pane"),u=Te("el-tabs"),C=He("loading");return Oe((v(),T("div",Qe,[c("div",Je,[e[24]||(e[24]=c("div",{class:"header-left"},[c("h1",{class:"page-title"},"大赛管理后台")],-1)),c("div",Xe,[a(l(y),{type:"text",onClick:Ve},{default:r(()=>[...e[23]||(e[23]=[c("i",{class:"el-icon-switch-button"},null,-1),n(" 退出登录 ",-1)])]),_:1})])]),c("div",Ke,[a(u,{modelValue:ge.value,"onUpdate:modelValue":e[22]||(e[22]=o=>ge.value=o),type:"card",class:"admin-tabs"},{default:r(()=>[a(i,{label:"报名信息管理",name:"teamManage"},{default:r(()=>[c("div",Ze,[a(l(D),{shadow:"hover",class:"query-card"},{default:r(()=>[a(l(K),{model:Z,inline:"",class:"query-form"},{default:r(()=>[a(l(_),{label:"作品ID"},{default:r(()=>[a(l(re),{modelValue:Z.workId,"onUpdate:modelValue":e[0]||(e[0]=o=>Z.workId=o),placeholder:"请输入作品ID",clearable:""},null,8,["modelValue"])]),_:1}),a(l(_),null,{default:r(()=>[a(l(y),{type:"primary",onClick:Le},{default:r(()=>[...e[25]||(e[25]=[n("查询",-1)])]),_:1}),a(l(y),{type:"success",onClick:he,loading:P.value},{default:r(()=>[...e[26]||(e[26]=[c("i",{class:"el-icon-download"},null,-1),n(" 导出已通过审核作品 ",-1)])]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])]),_:1}),a(l(D),{shadow:"hover",class:"table-card",style:{"margin-top":"20px"}},{default:r(()=>[a(l(se),{data:M.value,border:"","empty-text":"暂无报名信息"},{default:r(()=>[a(l(d),{prop:"workId",label:"作品ID",width:"180"},{default:r(o=>[c("span",el,f(o.row.workId),1)]),_:1}),a(l(d),{prop:"teamName",label:"队伍名称",width:"200"}),a(l(d),{prop:"groupType",label:"参赛组别",width:"250"},{default:r(o=>[a(l(de),null,{default:r(()=>[n(f(Ce(o.row.groupType)),1)]),_:2},1024)]),_:1}),a(l(d),{prop:"projectName",label:"项目名称","min-width":"200"}),a(l(d),{prop:"school",label:"报名学校",width:"200"}),a(l(d),{label:"队员人数",width:"100"},{default:r(o=>[n(f(o.row.members?.length||0)+"人",1)]),_:1}),a(l(d),{label:"指导教师","min-width":"200"},{default:r(o=>[n(f(o.row.teacher1?.name||"-")+" ",1),o.row.teacher2?.name?(v(),T("span",ll,"、"+f(o.row.teacher2.name),1)):H("",!0)]),_:1}),a(l(d),{label:"操作",width:"150"},{default:r(o=>[a(l(y),{type:"primary",size:"small",onClick:p=>De(o.row)},{default:r(()=>[...e[27]||(e[27]=[n("查看详情",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1})]),a(l(ye),{modelValue:fe.value,"onUpdate:modelValue":e[1]||(e[1]=o=>fe.value=o),title:"报名详情",width:"80%","append-to-body":""},{default:r(()=>[m.value?(v(),T("div",al,[c("div",tl,[e[28]||(e[28]=c("h3",{class:"section-title"},"基础信息",-1)),a(l(be),{column:2,border:""},{default:r(()=>[a(l(h),{label:"作品ID"},{default:r(()=>[n(f(m.value.workId),1)]),_:1}),a(l(h),{label:"队伍名称"},{default:r(()=>[n(f(m.value.teamName),1)]),_:1}),a(l(h),{label:"参赛组别"},{default:r(()=>[n(f(Ce(m.value.groupType)),1)]),_:1}),a(l(h),{label:"项目名称"},{default:r(()=>[n(f(m.value.projectName),1)]),_:1}),a(l(h),{label:"报名学校"},{default:r(()=>[n(f(m.value.school),1)]),_:1}),a(l(h),{label:"参赛专业"},{default:r(()=>[n(f(m.value.major),1)]),_:1})]),_:1})]),c("div",ol,[e[31]||(e[31]=c("h3",{class:"section-title"},"队员信息",-1)),a(l(se),{data:m.value.members,border:"","empty-text":"暂无队员信息"},{default:r(()=>[a(l(d),{label:"序号",width:"80",align:"center"},{default:r(({$index:o})=>[n(f(o+1),1)]),_:1}),a(l(d),{prop:"name",label:"姓名",width:"100"}),a(l(d),{prop:"gender",label:"性别",width:"80"}),a(l(d),{prop:"college",label:"学院","min-width":"150"}),a(l(d),{prop:"majorGrade",label:"专业/年级","min-width":"180"}),a(l(d),{prop:"phone",label:"手机号","min-width":"150"}),a(l(d),{prop:"email",label:"邮箱","min-width":"200"}),a(l(d),{label:"上传文件","min-width":"300"},{default:r(o=>[o.row.photoList&&o.row.photoList.length>0?(v(),T("div",rl,[(v(!0),T(Y,null,W(o.row.photoList,(p,g)=>(v(),I(l(y),{key:`view-${g}`,type:"text",size:"small",onClick:q=>Ue(p,!1)},{default:r(()=>[n(" 预览学生证照片 "+f(g+1)+" ",1),e[29]||(e[29]=c("i",{class:"el-icon-view"},null,-1))]),_:2},1032,["onClick"]))),128)),(v(!0),T(Y,null,W(o.row.photoList,(p,g)=>(v(),I(l(y),{key:`download-${g}`,type:"text",size:"small",style:{color:"#67C23A"},onClick:q=>Ue(p,!0)},{default:r(()=>[n(" 下载学生证照片 "+f(g+1)+" ",1),e[30]||(e[30]=c("i",{class:"el-icon-download"},null,-1))]),_:2},1032,["onClick"]))),128))])):(v(),T("span",sl,"未上传文件"))]),_:1})]),_:1},8,["data"])]),c("div",nl,[e[34]||(e[34]=c("h3",{class:"section-title"},"指导教师信息",-1)),m.value.teacher1?(v(),I(l(D),{key:0,class:"teacher-card-result",style:{"margin-bottom":"10px"}},{default:r(()=>[e[32]||(e[32]=c("h5",null,"指导教师1",-1)),a(l(be),{column:2,border:""},{default:r(()=>[a(l(h),{label:"姓名"},{default:r(()=>[n(f(m.value.teacher1.name||"-"),1)]),_:1}),a(l(h),{label:"性别"},{default:r(()=>[n(f(m.value.teacher1.gender||"-"),1)]),_:1}),a(l(h),{label:"职务"},{default:r(()=>[n(f(m.value.teacher1.position||"-"),1)]),_:1}),a(l(h),{label:"职称"},{default:r(()=>[n(f(m.value.teacher1.title||"-"),1)]),_:1}),a(l(h),{label:"单位"},{default:r(()=>[n(f(m.value.teacher1.unit||"-"),1)]),_:1}),a(l(h),{label:"手机号码"},{default:r(()=>[n(f(m.value.teacher1.phone||"-"),1)]),_:1}),a(l(h),{label:"电子邮箱",span:2},{default:r(()=>[n(f(m.value.teacher1.email||"-"),1)]),_:1})]),_:1})]),_:1})):H("",!0),m.value.teacher2&&m.value.teacher2.name?(v(),I(l(D),{key:1,class:"teacher-card-result"},{default:r(()=>[e[33]||(e[33]=c("h5",null,"指导教师2",-1)),a(l(be),{column:2,border:""},{default:r(()=>[a(l(h),{label:"姓名"},{default:r(()=>[n(f(m.value.teacher2.name||"-"),1)]),_:1}),a(l(h),{label:"性别"},{default:r(()=>[n(f(m.value.teacher2.gender||"-"),1)]),_:1}),a(l(h),{label:"职务"},{default:r(()=>[n(f(m.value.teacher2.position||"-"),1)]),_:1}),a(l(h),{label:"职称"},{default:r(()=>[n(f(m.value.teacher2.title||"-"),1)]),_:1}),a(l(h),{label:"单位"},{default:r(()=>[n(f(m.value.teacher2.unit||"-"),1)]),_:1}),a(l(h),{label:"手机号码"},{default:r(()=>[n(f(m.value.teacher2.phone||"-"),1)]),_:1}),a(l(h),{label:"电子邮箱",span:2},{default:r(()=>[n(f(m.value.teacher2.email||"-"),1)]),_:1})]),_:1})]),_:1})):H("",!0),!m.value.teacher1&&!m.value.teacher2?(v(),T("div",il," 暂无指导教师信息 ")):H("",!0)])])):H("",!0)]),_:1},8,["modelValue"])]),_:1}),a(i,{label:"公示发布",name:"noticeManage"},{default:r(()=>[c("div",ul,[a(l(D),{shadow:"hover",class:"operate-card"},{default:r(()=>[a(l(K),{model:R,inline:"",class:"query-form"},{default:r(()=>[a(l(_),{label:"公示类型"},{default:r(()=>[a(l(ne),{modelValue:R.publicType,"onUpdate:modelValue":e[2]||(e[2]=o=>R.publicType=o),clearable:"",onChange:ae},{default:r(()=>[a(l(F),{label:"获奖公示",value:"获奖公示"}),a(l(F),{label:"初审公示",value:"初审公示"}),a(l(F),{label:"终审公示",value:"终审公示"})]),_:1},8,["modelValue"])]),_:1}),a(l(_),{label:"所属年份"},{default:r(()=>[a(l(ne),{modelValue:R.year,"onUpdate:modelValue":e[3]||(e[3]=o=>R.year=o),clearable:"",onChange:ae},{default:r(()=>[(v(!0),T(Y,null,W(ue.value,o=>(v(),I(l(F),{key:o,label:o,value:o},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(l(_),null,{default:r(()=>[a(l(y),{type:"primary",onClick:e[4]||(e[4]=o=>ke())},{default:r(()=>[...e[35]||(e[35]=[c("i",{class:"el-icon-plus"},null,-1),n(" 新增公示 ",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),a(l(D),{shadow:"hover",class:"table-card",style:{"margin-top":"20px"}},{default:r(()=>[a(l(se),{data:ee.value,border:"","empty-text":"暂无公示信息"},{default:r(()=>[a(l(d),{prop:"id",label:"序号",width:"80",align:"center"}),a(l(d),{prop:"title",label:"公示标题","min-width":"200"}),a(l(d),{prop:"publicTime",label:"公示时间",width:"180"}),a(l(d),{prop:"publicType",label:"公示类型",width:"150"},{default:r(o=>[a(l(de),{type:"success"},{default:r(()=>[n(f(o.row.publicType),1)]),_:2},1024)]),_:1}),a(l(d),{label:"公示文件","min-width":"200"},{default:r(o=>[o.row.files.length>0?(v(),T("div",dl,[(v(!0),T(Y,null,W(o.row.files,(p,g)=>(v(),I(l(y),{key:g,type:"text",size:"small",onClick:q=>me(p.fileUrl,!0,p.fileName)},{default:r(()=>[n(f(p.fileName)+" ",1),e[36]||(e[36]=c("i",{class:"el-icon-download"},null,-1))]),_:2},1032,["onClick"]))),128))])):(v(),T("span",pl,"-"))]),_:1}),a(l(d),{label:"操作",width:"200"},{default:r(o=>[a(l(y),{type:"info",size:"small",onClick:p=>ke(o.row)},{default:r(()=>[...e[37]||(e[37]=[n("编辑",-1)])]),_:1},8,["onClick"]),a(l(y),{type:"danger",size:"small",onClick:p=>qe(o.row.id)},{default:r(()=>[...e[38]||(e[38]=[n("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1})]),a(l(ye),{modelValue:le.value,"onUpdate:modelValue":e[9]||(e[9]=o=>le.value=o),title:j.value?"编辑公示":"新增公示",width:"70%","append-to-body":""},{footer:r(()=>[a(l(y),{onClick:e[8]||(e[8]=o=>le.value=!1)},{default:r(()=>[...e[41]||(e[41]=[n("取消",-1)])]),_:1}),a(l(y),{type:"primary",onClick:Ee},{default:r(()=>[...e[42]||(e[42]=[n("保存",-1)])]),_:1})]),default:r(()=>[a(l(K),{model:U,"label-width":"100px"},{default:r(()=>[a(l(_),{label:"公示标题",required:""},{default:r(()=>[a(l(re),{modelValue:U.title,"onUpdate:modelValue":e[5]||(e[5]=o=>U.title=o),placeholder:"请输入公示标题"},null,8,["modelValue"])]),_:1}),a(l(_),{label:"公示时间",required:""},{default:r(()=>[a(l(xe),{modelValue:U.publicTime,"onUpdate:modelValue":e[6]||(e[6]=o=>U.publicTime=o),type:"date",placeholder:"请选择公示时间",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),a(l(_),{label:"公示类型",required:""},{default:r(()=>[a(l(ne),{modelValue:U.publicType,"onUpdate:modelValue":e[7]||(e[7]=o=>U.publicType=o),placeholder:"请选择公示类型"},{default:r(()=>[a(l(F),{label:"获奖公示",value:"获奖公示"}),a(l(F),{label:"初审公示",value:"初审公示"}),a(l(F),{label:"终审公示",value:"终审公示"})]),_:1},8,["modelValue"])]),_:1}),a(l(_),{label:"公示文件"},{default:r(()=>[a(l(Ne),{action:G.action,headers:G.headers,"on-success":G.onSuccess,"on-error":G.onError,"before-upload":G.beforeUpload,"on-remove":G.onRemove,limit:5,"file-list":S.value,multiple:""},{default:r(()=>[a(l(y),{size:"small",type:"primary"},{default:r(()=>[...e[39]||(e[39]=[n("点击上传PDF文件",-1)])]),_:1}),e[40]||(e[40]=c("div",{slot:"tip",class:"el-upload__tip"},"仅支持PDF，最多5个",-1))]),_:1},8,["action","headers","on-success","on-error","before-upload","on-remove","file-list"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])]),_:1}),a(i,{label:"通知发布",name:"messageManage"},{default:r(()=>[c("div",fl,[a(l(D),{shadow:"hover",class:"operate-card"},{default:r(()=>[a(l(K),{model:Q,inline:"",class:"query-form"},{default:r(()=>[a(l(_),{label:"所属年份"},{default:r(()=>[a(l(ne),{modelValue:Q.year,"onUpdate:modelValue":e[10]||(e[10]=o=>Q.year=o),clearable:"",onChange:ce},{default:r(()=>[(v(!0),T(Y,null,W(E.value,o=>(v(),I(l(F),{key:o,label:o,value:o},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(l(_),null,{default:r(()=>[a(l(y),{type:"primary",onClick:e[11]||(e[11]=o=>$e())},{default:r(()=>[...e[43]||(e[43]=[c("i",{class:"el-icon-plus"},null,-1),n(" 新增通知",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),a(l(D),{shadow:"hover",class:"table-card",style:{"margin-top":"20px"}},{default:r(()=>[a(l(se),{data:J.value,border:"","empty-text":"暂无通知信息"},{default:r(()=>[a(l(d),{prop:"id",label:"序号",width:"80",align:"center"}),a(l(d),{prop:"title",label:"通知标题","min-width":"200"}),a(l(d),{prop:"time",label:"发布时间",width:"180"}),a(l(d),{prop:"year",label:"所属年份",width:"100"},{default:r(o=>[a(l(de),null,{default:r(()=>[n(f(o.row.year),1)]),_:2},1024)]),_:1}),a(l(d),{label:"附件","min-width":"200"},{default:r(o=>[o.row.files.length>0?(v(),T("div",cl,[(v(!0),T(Y,null,W(o.row.files,(p,g)=>(v(),I(l(y),{key:g,type:"text",size:"small",onClick:q=>me(p.fileUrl,!0,p.fileName)},{default:r(()=>[n(f(p.fileName)+" ",1),e[44]||(e[44]=c("i",{class:"el-icon-download"},null,-1))]),_:2},1032,["onClick"]))),128))])):(v(),T("span",ml,"-"))]),_:1}),a(l(d),{label:"操作",width:"200"},{default:r(o=>[a(l(y),{type:"info",size:"small",onClick:p=>$e(o.row)},{default:r(()=>[...e[45]||(e[45]=[n("编辑",-1)])]),_:1},8,["onClick"]),a(l(y),{type:"danger",size:"small",onClick:p=>Se(o.row.id)},{default:r(()=>[...e[46]||(e[46]=[n("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1})]),a(l(ye),{modelValue:te.value,"onUpdate:modelValue":e[16]||(e[16]=o=>te.value=o),title:O.value?"编辑通知":"新增通知",width:"70%","append-to-body":""},{footer:r(()=>[a(l(y),{onClick:e[15]||(e[15]=o=>te.value=!1)},{default:r(()=>[...e[49]||(e[49]=[n("取消",-1)])]),_:1}),a(l(y),{type:"primary",onClick:Me},{default:r(()=>[...e[50]||(e[50]=[n("保存",-1)])]),_:1})]),default:r(()=>[a(l(K),{model:$,"label-width":"100px"},{default:r(()=>[a(l(_),{label:"通知标题",required:""},{default:r(()=>[a(l(re),{modelValue:$.title,"onUpdate:modelValue":e[12]||(e[12]=o=>$.title=o),placeholder:"请输入通知标题"},null,8,["modelValue"])]),_:1}),a(l(_),{label:"发布时间",required:""},{default:r(()=>[a(l(xe),{modelValue:$.time,"onUpdate:modelValue":e[13]||(e[13]=o=>$.time=o),type:"date",placeholder:"请选择发布时间","value-format":"YYYY-MM-DD",style:{width:"100%"},onChange:ze},null,8,["modelValue"])]),_:1}),a(l(_),{label:"所属年份",required:""},{default:r(()=>[a(l(ne),{modelValue:$.year,"onUpdate:modelValue":e[14]||(e[14]=o=>$.year=o),placeholder:"请选择所属年份"},{default:r(()=>[(v(!0),T(Y,null,W(E.value,o=>(v(),I(l(F),{key:o,label:o,value:o},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(l(_),{label:"通知附件"},{default:r(()=>[a(l(Ne),{action:X.action,headers:X.headers,"on-success":X.onSuccess,"on-error":X.onError,"before-upload":X.beforeUpload,"on-remove":X.onRemove,limit:5,"file-list":A.value,multiple:""},{default:r(()=>[a(l(y),{size:"small",type:"primary"},{default:r(()=>[...e[47]||(e[47]=[n("点击上传PDF文件",-1)])]),_:1}),e[48]||(e[48]=c("div",{slot:"tip",class:"el-upload__tip"},"仅支持PDF，最多5个",-1))]),_:1},8,["action","headers","on-success","on-error","before-upload","on-remove","file-list"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])]),_:1}),a(i,{label:"作品上传审核",name:"fileAudit"},{default:r(()=>[c("div",vl,[a(l(D),{shadow:"hover",class:"query-card"},{default:r(()=>[a(l(K),{model:L,inline:"",class:"query-form"},{default:r(()=>[a(l(_),{label:"作品ID"},{default:r(()=>[a(l(re),{modelValue:L.workId,"onUpdate:modelValue":e[17]||(e[17]=o=>L.workId=o),placeholder:"请输入作品ID",clearable:"",onClear:oe},null,8,["modelValue"])]),_:1}),a(l(_),{label:"文件名"},{default:r(()=>[a(l(re),{modelValue:L.fileName,"onUpdate:modelValue":e[18]||(e[18]=o=>L.fileName=o),placeholder:"请输入文件名关键词",clearable:"",onClear:oe},null,8,["modelValue"])]),_:1}),a(l(_),null,{default:r(()=>[a(l(y),{type:"primary",onClick:Ae},{default:r(()=>[...e[51]||(e[51]=[n("查询",-1)])]),_:1}),a(l(y),{onClick:e[19]||(e[19]=()=>{L.workId="",L.fileName="",oe()})},{default:r(()=>[...e[52]||(e[52]=[n(" 重置 ",-1)])]),_:1}),a(l(y),{type:"success",onClick:he,loading:P.value},{default:r(()=>[...e[53]||(e[53]=[c("i",{class:"el-icon-download"},null,-1),n(" 导出已通过审核作品 ",-1)])]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])]),_:1}),a(l(D),{shadow:"hover",class:"table-card",style:{"margin-top":"20px"}},{default:r(()=>[a(l(se),{data:N.value,border:"","empty-text":"暂无文件信息"},{default:r(()=>[a(l(d),{prop:"workId",label:"作品ID",width:"180"}),a(l(d),{prop:"originalFileName",label:"文件名","min-width":"200"}),a(l(d),{label:"文件大小",width:"120"},{default:r(o=>[n(f(o.row.fileSize?(o.row.fileSize/1024/1024).toFixed(2):0)+" MB ",1)]),_:1}),a(l(d),{prop:"fileType",label:"文件类型",width:"150"}),a(l(d),{prop:"uploadTime",label:"上传时间",width:"200"}),a(l(d),{label:"审核状态",width:"120"},{default:r(o=>[a(l(de),{type:o.row.status===1?"success":o.row.status===2?"danger":"warning"},{default:r(()=>[n(f(o.row.auditStatusText),1)]),_:2},1032,["type"])]),_:1}),a(l(d),{label:"操作",width:"250"},{default:r(o=>[a(l(y),{type:"info",size:"small",onClick:p=>Be(o.row.fileUrl)},{default:r(()=>[...e[54]||(e[54]=[n("下载",-1)])]),_:1},8,["onClick"]),o.row.status?H("",!0):(v(),I(l(y),{key:0,type:"success",size:"small",onClick:p=>_e(o.row,!0)},{default:r(()=>[...e[55]||(e[55]=[n("审核通过",-1)])]),_:1},8,["onClick"])),o.row.status?H("",!0):(v(),I(l(y),{key:1,type:"danger",size:"small",onClick:p=>_e(o.row,!1)},{default:r(()=>[...e[56]||(e[56]=[n("审核驳回",-1)])]),_:1},8,["onClick"]))]),_:1})]),_:1},8,["data"]),a(l(We),{onSizeChange:e[20]||(e[20]=o=>V.pageSize=o),onCurrentChange:e[21]||(e[21]=o=>V.pageNum=o),"current-page":V.pageNum,"page-sizes":[10,20,50],"page-size":V.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:V.total,style:{"margin-top":"20px","text-align":"right"}},null,8,["current-page","page-size","total"])]),_:1})])]),_:1})]),_:1},8,["modelValue"])])])),[[C,b.value]])}}},hl=Pe(yl,[["__scopeId","data-v-e9114a12"]]);export{hl as default};
