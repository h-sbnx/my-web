import{_ as X,e as q,c as i,a as _,b as o,w as r,i as V,E as y,j as g,r as u,o as a,F as $,g as Y,h as x,u as M,d as h,t as f,f as P}from"./index-DY4mJ8SQ.js";const j={class:"public-page"},z={class:"public-container"},A={class:"year-selector",style:{"margin-bottom":"20px"}},I={key:0,style:{"text-align":"center",padding:"40px 0",color:"#999"}},O={key:1,class:"empty-tip",style:{"text-align":"center",padding:"40px 0",color:"#999"}},U={key:0,class:"file-list"},W={key:1,style:{color:"#999"}},G={key:3,class:"public-tip"},H={__name:"PublicView",setup(J){const b=g([]),d=g(""),v=g([]),p=g(!1),B=async()=>{try{p.value=!0;const t=await V.get("/public/queryAllYears");t.code===200&&(b.value=t.data||[],b.value.length>0&&(d.value=b.value[0],C(d.value)))}catch(t){console.error("加载公示年份失败",t),y.error("加载公示年份失败，请刷新重试")}finally{p.value=!1}},C=async t=>{if(t)try{p.value=!0;const e=await V.get("/public/queryByYear",{params:{year:t}});e.code===200&&(v.value=e.data.map(n=>({...n,files:n.files||[]})))}catch(e){console.error("加载赛事公示数据失败",e),y.error("加载公示数据失败，请刷新重试")}finally{p.value=!1}},D=t=>{d.value=t,C(t)};q(()=>{B()});const N=t=>{if(!t)return"";const e=new Date(t),n=e.getFullYear(),s=String(e.getMonth()+1).padStart(2,"0"),c=String(e.getDate()).padStart(2,"0");return`${n}-${s}-${c}`},T=(t,e=!1,n="")=>{try{let s=t;if(t.startsWith("http")||(s=`http://localhost:8080${t}`),e){const c=document.createElement("a");c.href=s,c.download=n||"文件",document.body.appendChild(c),c.click(),document.body.removeChild(c),y.success(`开始下载：${n||"文件"}`)}else window.open(s,"_blank")}catch(s){console.error("文件操作失败：",s),y.error("文件预览/下载失败，请重试")}};return(t,e)=>{const n=u("el-option"),s=u("el-select"),c=u("el-icon"),m=u("el-table-column"),E=u("el-tag"),F=u("el-button"),L=u("el-table"),S=u("el-card");return a(),i("div",j,[_("div",z,[e[4]||(e[4]=_("h2",{class:"page-title"},"赛事公示",-1)),_("div",A,[o(s,{modelValue:d.value,"onUpdate:modelValue":e[0]||(e[0]=l=>d.value=l),placeholder:"请选择年份",style:{width:"200px"},onChange:D,disabled:p.value},{default:r(()=>[(a(!0),i($,null,Y(b.value,l=>(a(),x(n,{key:l,label:`${l}年`,value:l},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),o(S,{class:"public-card"},{default:r(()=>[p.value?(a(),i("div",I,[o(c,null,{default:r(()=>[o(M(p))]),_:1}),e[1]||(e[1]=h(" 加载中... ",-1))])):v.value.length===0?(a(),i("div",O," 暂无"+f(d.value)+"年赛事公示数据 ",1)):(a(),x(L,{key:2,data:v.value,border:"",style:{width:"100%"},class:"public-table"},{default:r(()=>[o(m,{prop:"id",label:"序号",width:"80",align:"center"}),o(m,{prop:"title",label:"公示标题","min-width":"300"}),o(m,{prop:"publicTime",label:"公示时间",width:"180",align:"center"},{default:r(l=>[h(f(N(l.row.publicTime)),1)]),_:1}),o(m,{prop:"publicType",label:"公示类型",width:"120",align:"center"},{default:r(l=>[o(E,{type:"info"},{default:r(()=>[h(f(l.row.publicType),1)]),_:2},1024)]),_:1}),o(m,{label:"公示文件","min-width":"200",align:"center"},{default:r(l=>[l.row.files.length>0?(a(),i("div",U,[(a(!0),i($,null,Y(l.row.files,(w,k)=>(a(),x(F,{key:k,type:"text",size:"small",onClick:K=>T(w.fileUrl,!0,w.fileName||`文件${k+1}`),style:{display:"block",margin:"4px 0",color:"#409eff"}},{default:r(()=>[h(f(w.fileName||`文件${k+1}`)+" ",1),e[2]||(e[2]=_("i",{class:"el-icon-download"},null,-1))]),_:2},1032,["onClick"]))),128))])):(a(),i("span",W,"无附件"))]),_:1})]),_:1},8,["data"])),v.value.length>0?(a(),i("div",G,[_("p",null,"公示时间："+f(d.value)+"年（具体以公示文件为准）",1),e[3]||(e[3]=_("p",null,"公示期间如有异议，请联系大赛组委会：0551-6516XXXX（巢老师）",-1))])):P("",!0)]),_:1})])])}}},R=X(H,[["__scopeId","data-v-cf1464c4"]]);export{R as default};
